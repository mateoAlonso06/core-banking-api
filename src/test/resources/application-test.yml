# --- CONFIGURACIÓN BASE PARA TESTS ---
spring:
  config:
    activate:
      on-profile: test
  
  application:
    name: core-bank-test

  # 1. POSTGRES (Testcontainers lo sobrescribirá, pero definimos esto para que arranque)
  datasource:
    url: jdbc:postgresql://localhost:5432/testdb
    username: test
    password: test
    driver-class-name: org.postgresql.Driver

  # 2. JPA / HIBERNATE
  jpa:
    hibernate:
      ddl-auto: validate # Recomendado para tests: crea y destruye
    show-sql: false # Útil para ver qué pasa en el test
    properties:
      hibernate:
        format_sql: true
    database-platform: org.hibernate.dialect.PostgreSQLDialect

  # 3. FLYWAY (Deshabilitar clean-disabled para poder limpiar la base si es necesario)
  flyway:
    enabled: true
    clean-disabled: false

# Deshabilitar servicios innecesarios en tests
mail:
  enabled: false

rate-limiting:
  enabled: false

# --- VARIABLES QUE CAUSAN ERROR (OVERRIDE) ---

# Sobrescribimos la sección JWT completa. Al poner el valor aquí,
# Spring IGNORA el ${JWT_SECRET} del archivo principal.
jwt:
  secret: una-clave-secreta-muy-larga-para-tests-12345678901234567890
  expiration-ms: 3600000 # 1 hora en milisegundos

# Sobrescribimos CORS para que no busque ${CORS_ALLOWED_ORIGINS}
cors:
  allowed-origins: "*"

# Sobrescribimos ADMIN SEED (vacío para deshabilitar el seeder en tests)
admin:
  seed:
    email: ""
    password: ""

# Desactivar logs ruidosos
logging:
  level:
    root: INFO
    org.hibernate.SQL: INFO
    com.banking.system: DEBUG